"use strict";exports.id=102,exports.ids=[102],exports.modules={6666:(t,e,a)=>{a.d(e,{A:()=>I});var r=a(10968),i=a(66513),n=a(37334),o=a(91386),s=a(94800),c=a(76690),l=a(31848),d=a(80165),m=a(60638),u=a(24101),p=a(21014),g=a(41532),h=a(39191),y=a(20230),P=a(15849),C=a(98502),v=a(61342);function b(t){return(0,v.Ay)("MuiMenuItem",t)}let A=(0,C.A)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]);var f=a(34691);let D=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],T=t=>{let{disabled:e,dense:a,divider:r,disableGutters:n,selected:o,classes:c}=t,l=(0,s.A)({root:["root",a&&"dense",e&&"disabled",!n&&"gutters",r&&"divider",o&&"selected"]},b,c);return(0,i.A)({},c,l)},w=(0,l.Ay)(u.A,{shouldForwardProp:t=>(0,l.ep)(t)||"classes"===t,name:"MuiMenuItem",slot:"Root",overridesResolver:(t,e)=>{let{ownerState:a}=t;return[e.root,a.dense&&e.dense,a.divider&&e.divider,!a.disableGutters&&e.gutters]}})(({theme:t,ownerState:e})=>(0,i.A)({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${A.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,c.X4)(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${A.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:(0,c.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${A.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:(0,c.X4)(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:(0,c.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${A.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${A.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${h.A.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${h.A.inset}`]:{marginLeft:52},[`& .${P.A.root}`]:{marginTop:0,marginBottom:0},[`& .${P.A.inset}`]:{paddingLeft:36},[`& .${y.A.root}`]:{minWidth:36}},!e.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&(0,i.A)({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${y.A.root} svg`]:{fontSize:"1.25rem"}}))),I=n.forwardRef(function(t,e){let a;let s=(0,d.A)({props:t,name:"MuiMenuItem"}),{autoFocus:c=!1,component:l="li",dense:u=!1,divider:h=!1,disableGutters:y=!1,focusVisibleClassName:P,role:C="menuitem",tabIndex:v,className:b}=s,A=(0,r.A)(s,D),I=n.useContext(m.A),F=n.useMemo(()=>({dense:u||I.dense||!1,disableGutters:y}),[I.dense,u,y]),x=n.useRef(null);(0,p.A)(()=>{c&&x.current&&x.current.focus()},[c]);let R=(0,i.A)({},s,{dense:F.dense,divider:h,disableGutters:y}),k=T(s),N=(0,g.A)(x,e);return s.disabled||(a=void 0!==v?v:-1),(0,f.jsx)(m.A.Provider,{value:F,children:(0,f.jsx)(w,(0,i.A)({ref:N,role:C,tabIndex:a,component:l,focusVisibleClassName:(0,o.A)(k.focusVisible,P),className:(0,o.A)(k.root,b)},A,{ownerState:R,classes:k}))})})},41211:(t,e,a)=>{a.d(e,{o:()=>i});var r=a(75671);let i=(0,r.createServerReference)("002f662226f6eaa0d3ac831331de3c10c5b6874bef",r.callServer,void 0,r.findSourceMapURL,"getPlanData")},78985:(t,e,a)=>{a.d(e,{b:()=>s});var r=a(75159),i=a(95372),n=a(17235),o=a(58469);class s{async create(t){let e=(0,o.Ak)(),[a]=await r.db.insert(i.items).values({...t,id:e}).returning();return a}async findById(t){let[e]=await r.db.select().from(i.items).where((0,n.eq)(i.items.id,t));return e}async searchItems(t){return await r.db.select().from(i.items).where((0,n.eq)(i.items.itemName,t))}async findAll(){return await r.db.select().from(i.items)}async update(t,e){let[a]=await r.db.update(i.items).set(e).where((0,n.eq)(i.items.id,t)).returning();return a}async delete(t){let[e]=await r.db.delete(i.items).where((0,n.eq)(i.items.id,t)).returning();return e}}},79557:(t,e,a)=>{a.d(e,{o:()=>y,q:()=>h});var r=a(19179);a(69347);var i=a(75159),n=a(95372),o=a(58469),s=a(98566),c=a(20946),l=a(37710),d=a(70014),m=a(78985),u=a(13611),p=a(66081),g=a(64840);async function h(t,e){try{console.log("계약 정보 저장 시작:",t),console.log("화물 정보 저장 시작:",e);let a=(0,o.Ak)(),r=(0,o.Ak)();try{let[e]=await i.db.insert(n.contracts).values({id:a,contractNumber:t.contractNumber,contractDate:t.contractDate,contractParty:t.contractParty,importer:t.importer,incoterms:t.incoterms}).returning();console.log("계약 정보 저장 완료:",e)}catch(t){throw console.error("계약 정보 저장 중 오류:",t),Error(`계약 정보 저장 실패: ${t instanceof Error?t.message:"알 수 없는 오류"}`)}try{let e=(0,o.Ak)(),[r]=await i.db.insert(n.payments).values({id:e,paymentDueDate:t.contractDate,paymentMethod:"T/T",contractId:a}).returning();console.log("결제 정보 저장 완료:",r);let[s]=await i.db.insert(n.paymentsTt).values({paymentId:e,advancePaymentDate:t.contractDate,advancePaymentRatio:30,advancePaymentAmount:0,remainingPaymentDate:t.contractDate,remainingPaymentRatio:70,remainingPaymentAmount:0,counterpartBank:""}).returning();console.log("T/T 결제 상세 정보 저장 완료:",s)}catch(t){throw console.error("결제 정보 저장 중 오류:",t),Error(`결제 정보 저장 실패: ${t instanceof Error?t.message:"알 수 없는 오류"}`)}try{let[e]=await i.db.insert(n.shipments).values({id:r,contractId:a,estimatedTimeArrival:t.estimatedTimeArrival,estimatedTimeDeparture:t.estimatedTimeDeparture,arrivalPort:t.arrivalPort,departurePort:t.departurePort}).returning();console.log("선적 정보 저장 완료:",e)}catch(t){throw console.error("선적 정보 저장 중 오류:",t),Error(`선적 정보 저장 실패: ${t instanceof Error?t.message:"알 수 없는 오류"}`)}for(let t of e)try{let e;let a=(0,o.Ak)(),s=await i.db.query.items.findFirst({where:(e,{eq:a,and:r})=>r(a(e.itemName,t.itemName),a(e.itemVariety,t.itemVariety),t.hsCode?a(e.hsCode,t.hsCode):void 0,a(e.packingUnit,t.packingUnit))});if(s)e=s.id;else{let[a]=await i.db.insert(n.items).values({id:(0,o.Ak)(),itemName:t.itemName,itemVariety:t.itemVariety,originCountry:null,hsCode:t.hsCode,packingUnit:t.packingUnit}).returning();e=a.id,console.log("새로운 품목 정보 저장 완료:",a)}let c=(0,o.Ak)(),l=t.unitPrice*t.exchangeRate*t.contractTon/1e3,[d]=await i.db.insert(n.cargos).values({id:c,itemsId:e,shipmentId:r,containerCount:1,contractTon:t.contractTon,progressStatus:"REVIEW",sellingPrice:t.sellingPrice,margin:t.sellingPrice-l,totalProfit:(t.sellingPrice-l)*t.contractTon*1e3,purchaseFeeRate:0}).returning();console.log("화물 정보 저장 완료:",d);let[m]=await i.db.insert(n.costs).values({id:a,cargoId:c,supplyPrice:t.unitPrice,laborCost:0,transportStorageFee:0,loadingUnloadingFee:0}).returning();console.log("비용 정보 저장 완료:",m);let[u]=await i.db.insert(n.costDetails).values({id:(0,o.Ak)(),costId:a,unitPrice:t.unitPrice,exchangeRate:t.exchangeRate,customsTaxRate:t.customsTaxRate,customTaxAmount:t.customTaxAmount,customsFee:t.customsFee,inspectionFee:t.inspectionFee,doCharge:0,otherCosts:t.otherCosts}).returning();console.log("비용 상세 정보 저장 완료:",u)}catch(t){throw console.error("화물 정보 저장 중 오류:",t),Error(`화물 정보 저장 실패: ${t instanceof Error?t.message:"알 수 없는 오류"}`)}return{success:!0,message:"계획이 성공적으로 저장되었습니다."}}catch(t){return console.error("계획 저장 중 오류 발생:",t),t instanceof Error&&console.error("오류 상세:",{message:t.message,stack:t.stack,name:t.name}),{success:!1,message:`계획 저장 중 오류가 발생했습니다: ${t instanceof Error?t.message:"알 수 없는 오류"}`}}}async function y(){try{let t=new c.y,e=new l.o,a=new d.q,r=new m.b,i=new u.T,n=new p.G,o=new g.W,[h,y,P,C,v,b,A]=await Promise.all([t.findAll(),e.findAll(),a.findAll(),r.findAll(),i.findAll(),n.findAll(),o.findAll()]);return P.map(t=>{let e=y.find(e=>e.id===t.shipmentId),a=h.find(t=>t.id===e?.contractId),r=C.find(e=>e.id===t?.itemsId),i=v.find(e=>e.cargoId===t?.id),n=b.find(t=>t.costId===i?.id),o=A.find(t=>t.contractId===a?.id),c={contract:{id:a?.id||"",contractNumber:a?.contractNumber||"",contractDate:a?.contractDate||"",contractParty:a?.contractParty||"",importer:a?.importer||"",incoterms:a?.incoterms||""},shipment:{id:e?.id||"",contractId:a?.id||"",estimatedTimeDeparture:e?.estimatedTimeDeparture||"",estimatedTimeArrival:e?.estimatedTimeArrival||"",shippingCompany:e?.shippingCompany||"",departurePort:e?.departurePort||"",arrivalPort:e?.arrivalPort||"",blNumber:e?.blNumber||"",palletOrderDate:e?.palletOrderDate||"",palletType:e?.palletType||""},cargo:{id:t?.id||"",itemsId:t?.itemsId||"",shipmentId:e?.id||"",containerCount:t?.containerCount||0,contractTon:t?.contractTon||0,progressStatus:t?.progressStatus||"예정",customsClearanceDate:t?.customsClearanceDate||"",quarantineDate:t?.quarantineDate||"",warehouseEntryDate:t?.warehouseEntryDate||"",sellingPrice:t?.sellingPrice||0,margin:t?.margin||0,totalProfit:t?.totalProfit||0,purchaseFeeRate:t?.purchaseFeeRate||0},cost:{id:i?.id||"",cargoId:t?.id||"",supplyPrice:i?.supplyPrice||0,shippingCost:i?.shippingCost||0,laborCost:i?.laborCost||0,transportStorageFee:i?.transportStorageFee||0,loadingUnloadingFee:i?.loadingUnloadingFee||0},costDetail:{id:n?.id||"",costId:i?.id||"",unitPrice:n?.unitPrice||0,exchangeRate:n?.exchangeRate||0,customsTaxRate:n?.customsTaxRate||0,customTaxAmount:n?.customTaxAmount||0,customsFee:n?.customsFee||0,inspectionFee:n?.inspectionFee||0,doCharge:n?.doCharge||0,otherCosts:n?.otherCosts||0,transferFee:n?.transferFee||0},payment:{id:o?.id||"",contractId:a?.id||"",paymentMethod:o?.paymentMethod||"",paymentDueDate:o?.paymentDueDate||"",advancePaymentDate:o?.advancePaymentDate||"",advancePaymentRatio:o?.advancePaymentRatio||0,advancePaymentAmount:o?.advancePaymentAmount||0,remainingPaymentDate:o?.remainingPaymentDate||"",remainingPaymentRatio:o?.remainingPaymentRatio||0,remainingPaymentAmount:o?.remainingPaymentAmount||0,counterpartBank:o?.counterpartBank||"",paymentTerm:o?.paymentTerm||"",totalContractAmount:o?.totalContractAmount||0},item:{id:r?.id||"",itemName:r?.itemName||"",itemVariety:r?.itemVariety||"",packingUnit:r?.packingUnit||"",originCountry:r?.originCountry||"",hsCode:r?.hsCode||""}},l=(0,s.s)(c);return{id:t?.id||"",contractNumber:a?.contractNumber||"",progressStatus:t?.progressStatus||"예정",contractDate:a?.contractDate||"",importer:a?.importer||"",contractParty:a?.contractParty||"",estimatedTimeArrival:e?.estimatedTimeArrival||"",arrivalPort:e?.arrivalPort||"",itemName:r?.itemName||"",contractTon:t?.contractTon||0,unitPrice:l.costDetail.unitPrice||0,totalPrice:l.costDetail.totalContractPrice||0,paymentMethod:o?.paymentMethod||"",warehouseEntryDate:t?.warehouseEntryDate||"",importCostPerKg:l.costDetail.costPerKg||0,supplyCostPerKg:l.cost.supplyPrice||0,totalCost:l.cost.contractorCost||0,totalCostPerKg:l.costDetail.costPerKg||0,sellingPrice:l.cargo.sellingPrice||0,margin:l.cargo.margin||0,totalProfit:l.cargo.totalProfit||0}})}catch(t){throw console.error("Failed to fetch plan data:",t),Error("계획 데이터를 불러오는데 실패했습니다.")}}(0,a(91935).D)([h,y]),(0,r.A)(h,"605b4f045eafa7bfea9a27361956d51e66e44e2375",null),(0,r.A)(y,"002f662226f6eaa0d3ac831331de3c10c5b6874bef",null)},98566:(t,e,a)=>{a.d(e,{s:()=>i});class r{constructor(t){this.data=t,this.calculatedValues=this.calculateValues()}calculateValues(){let t=this.data.costDetail.unitPrice||0,e=this.data.costDetail.exchangeRate||0,a=this.data.cargo.contractTon||0,r=this.data.cargo.sellingPrice||0,i=this.data.cargo.purchaseFeeRate||0,n=t*e*a,o=(n+(this.data.costDetail.customTaxAmount||0)+(this.data.costDetail.customsFee||0)+(this.data.costDetail.inspectionFee||0)+(this.data.costDetail.doCharge||0)+(this.data.costDetail.otherCosts||0))/a/1e3,s=o*(1+i/100)*a*1e3,c=s+(this.data.cost.shippingCost||0)+(this.data.cost.laborCost||0)+(this.data.cost.transportStorageFee||0)+(this.data.cost.loadingUnloadingFee||0),l=r-c/a/1e3;return{supplyPrice:t*e*a/1e3,margin:l,totalProfit:l*a*1e3,totalContractPrice:n,costPerKg:t*e/1e3,contractorCost:o,contractorProfit:s,totalCost:c}}mapItem(t){return{id:t.id,itemName:t.itemName||"",itemVariety:t.itemVariety||"",originCountry:t.originCountry||"",hsCode:t.hsCode||"",packingUnit:t.packingUnit||""}}mapShipment(t){return{id:t.id,estimatedTimeArrival:t.estimatedTimeArrival||"",estimatedTimeDeparture:t.estimatedTimeDeparture||"",arrivalPort:t.arrivalPort||"",departurePort:t.departurePort||"",blNumber:t.blNumber||"",palletOrderDate:t.palletOrderDate||"",palletType:t.palletType||"",shippingCompany:t.shippingCompany||"",contractId:t.contractId||""}}mapContract(t,e){return{id:t.id,incoterms:t.incoterms||"",contractNumber:t.contractNumber||"",contractDate:t.contractDate||"",contractParty:t.contractParty||"",importer:t.importer||"",departurePort:e.departurePort||"",arrivalPort:e.arrivalPort||"",estimatedTimeDeparture:e.estimatedTimeDeparture||"",estimatedTimeArrival:e.estimatedTimeArrival||"",blNumber:e.blNumber||""}}mapPayment(t){return{id:t.id,paymentDueDate:t.paymentDueDate||"",paymentMethod:t.paymentMethod||"",contractId:t.contractId,advancePaymentDate:t.advancePaymentDate||"",advancePaymentRatio:t.advancePaymentRatio||0,advancePaymentAmount:t.advancePaymentAmount||0,remainingPaymentDate:t.remainingPaymentDate||"",remainingPaymentRatio:t.remainingPaymentRatio||0,remainingPaymentAmount:t.remainingPaymentAmount||0,counterpartBank:t.counterpartBank||"",paymentTerm:t.paymentTerm||"",totalContractAmount:this.calculatedValues.totalContractPrice}}mapAndCalculateCostDetail(t){return{id:t.id,unitPrice:t.unitPrice||0,totalContractPrice:this.calculatedValues.totalContractPrice,exchangeRate:t.exchangeRate||0,costPerKg:this.calculatedValues.costPerKg,costId:t.costId,customTaxAmount:t.customTaxAmount||0,customsTaxRate:t.customsTaxRate||0,customsFee:t.customsFee||0,inspectionFee:t.inspectionFee||0,doCharge:t.doCharge||0,otherCosts:t.otherCosts||0,transferFee:t.transferFee||0}}mapAndCalculateContractAmount(t,e){return{id:e.id,cargoId:e.cargoId,contractorCost:this.calculatedValues.contractorCost,supplyPrice:this.calculatedValues.contractorCost*(1+(t.purchaseFeeRate||0)/100),contractorProfit:this.calculatedValues.contractorProfit,shippingCost:e.shippingCost||0,laborCost:e.laborCost||0,transportStorageFee:e.transportStorageFee||0,loadingUnloadingFee:e.loadingUnloadingFee||0}}mapAndCalculateExpense(t){return{id:t.id,itemsId:t.itemsId,shipmentId:t.shipmentId,containerCount:t.containerCount,contractTon:t.contractTon,customsClearanceDate:t.customsClearanceDate,quarantineDate:t.quarantineDate,warehouseEntryDate:t.warehouseEntryDate,progressStatus:t.progressStatus,totalCost:this.calculatedValues.totalCost,sellingPrice:t.sellingPrice||0,margin:this.calculatedValues.margin,totalProfit:this.calculatedValues.totalProfit,purchaseFeeRate:t.purchaseFeeRate}}calculate(){return{contract:this.mapContract(this.data.contract,this.data.shipment),payment:this.mapPayment(this.data.payment),costDetail:this.mapAndCalculateCostDetail(this.data.costDetail),cost:this.mapAndCalculateContractAmount(this.data.cargo,this.data.cost),cargo:this.mapAndCalculateExpense(this.data.cargo),item:this.mapItem(this.data.item),shipment:this.mapShipment(this.data.shipment)}}}function i(t){return new r(t).calculate()}}};
