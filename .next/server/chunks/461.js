"use strict";exports.id=461,exports.ids=[461],exports.modules={2463:(e,r,t)=>{t.d(r,{x:()=>u});var n=t(11417),a=t(57482),c=t(32490),o=t(34812),i=t(11432);function s(e){return e.substring(2).toLowerCase()}function u(e){let{children:r,disableReactTree:t=!1,mouseEvent:u="onClick",onClickAway:l,touchEvent:d="onTouchEnd"}=e,m=n.useRef(!1),f=n.useRef(null),p=n.useRef(!1),y=n.useRef(!1);n.useEffect(()=>(setTimeout(()=>{p.current=!0},0),()=>{p.current=!1}),[]);let w=(0,a.A)(r.ref,f),h=(0,c.A)(e=>{let r;let n=y.current;y.current=!1;let a=(0,o.A)(f.current);if(p.current&&f.current&&(!("clientX"in e)||!(a.documentElement.clientWidth<e.clientX)&&!(a.documentElement.clientHeight<e.clientY))){if(m.current){m.current=!1;return}(e.composedPath?e.composedPath().indexOf(f.current)>-1:!a.documentElement.contains(e.target)||f.current.contains(e.target))||!t&&n||l(e)}}),g=e=>t=>{y.current=!0;let n=r.props[e];n&&n(t)},b={ref:w};return!1!==d&&(b[d]=g(d)),n.useEffect(()=>{if(!1!==d){let e=s(d),r=(0,o.A)(f.current),t=()=>{m.current=!0};return r.addEventListener(e,h),r.addEventListener("touchmove",t),()=>{r.removeEventListener(e,h),r.removeEventListener("touchmove",t)}}},[h,d]),!1!==u&&(b[u]=g(u)),n.useEffect(()=>{if(!1!==u){let e=s(u),r=(0,o.A)(f.current);return r.addEventListener(e,h),()=>{r.removeEventListener(e,h)}}},[h,u]),(0,i.jsx)(n.Fragment,{children:n.cloneElement(r,b)})}},21316:(e,r,t)=>{t.d(r,{Y:()=>u});var n=t(13913),a=t(8613),c=t(26763),o=t(10854),i=t(98149),s=t(70564);class u{async createImporter(e,r,t){try{let[o]=await n.db.insert(a.importers).values({id:(0,c.Ak)(),importerName:e,importerCode:r,calculationType:t}).returning();return{...o}}catch(e){throw console.error("수입업체 생성 중 오류:",e),Error(`수입업체 생성 실패: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}}async getAllImporters(){try{return(await n.db.query.importers.findMany()).map(e=>({...e}))}catch(e){throw console.error("수입업체 조회 중 오류:",e),Error(`수입업체 조회 실패: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}}async getImporterById(e){try{let r=await n.db.query.importers.findFirst({where:(0,i.eq)(a.importers.id,e)});if(!r)throw Error("수입업체를 찾을 수 없습니다.");return{...r}}catch(e){throw console.error("수입업체 조회 중 오류:",e),Error(`수입업체 조회 실패: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}}async updateImporter(e,r){let t=new s.y;try{if(!r.importerName)throw Error("이름이 필요합니다.");let e=await this.findByName(r.importerName);if(e)return(await t.findByImporterId(e.id)).length<2&&this.deleteImporter(e.id),e;let n=await this.createImporter(r.importerName,r.importerCode||"gompyo",function(e){switch(e){case"DNB":return o.A.DNB;case"남해":return o.A.NAMHAE;default:return o.A.STANDARD}}(r.importerName));if(!n)throw Error("수입업체를 찾을 수 없습니다.");return{...n}}catch(e){throw console.error("수입업체 업데이트 중 오류:",e),Error(`수입업체 업데이트 실패: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}}async deleteImporter(e){try{let[r]=await n.db.delete(a.importers).where((0,i.eq)(a.importers.id,e)).returning();if(!r)throw Error("수입업체를 찾을 수 없습니다.");return{...r}}catch(e){throw console.error("수입업체 삭제 중 오류:",e),Error(`수입업체 삭제 실패: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}}async searchImportersByName(e){try{return(await n.db.query.importers.findMany({where:(0,i.mj)(a.importers.importerName,`%${e}%`)})).map(e=>({...e}))}catch(e){throw console.error("수입업체 검색 중 오류:",e),Error(`수입업체 검색 실패: ${e instanceof Error?e.message:"알 수 없는 오류"}`)}}async findByName(e){let[r]=await n.db.select().from(a.importers).where((0,i.eq)(a.importers.importerName,e));return r}}},24227:(e,r,t)=>{t.d(r,{A:()=>n});var n=function(e){return e.STANDARD="STANDARD",e.DNB="DNB",e.NAMHAE="NAMHAE",e}({})},36405:(e,r,t)=>{t.d(r,{wz:()=>y,Dm:()=>w,OA:()=>h,Lx:()=>f,y4:()=>p,Mo:()=>g,Fq:()=>b});var n=t(17464);t(55414);var a=t(19541),c=t(14567),o=t(15198),i=t(13913),s=t(8613),u=t(98149);class l{async findByEmail(e){let[r]=await i.db.select().from(s.users).where((0,u.eq)(s.users.email,e));return r}async findById(e){let[r]=await i.db.select().from(s.users).where((0,u.eq)(s.users.id,e));return r}async getPlanColumnOrder(e){let r=await this.findById(e);return r.planColumnOrder?JSON.parse(r.planColumnOrder):null}async getShipmentColumnOrder(e){let r=await this.findById(e);return r.shipmentColumnOrder?JSON.parse(r.shipmentColumnOrder):null}async updatePlanColumnOrder(e,r){let[t]=await i.db.update(s.users).set({planColumnOrder:r}).where((0,u.eq)(s.users.id,e)).returning();return t}async updateShipmentColumnOrder(e,r){let[t]=await i.db.update(s.users).set({shipmentColumnOrder:r}).where((0,u.eq)(s.users.id,e)).returning();return t}async create(e){let[r]=await i.db.insert(s.users).values(e).returning();return r}async delete(e){return await i.db.delete(s.users).where((0,u.eq)(s.users.id,e)),!0}}var d=t(1634);let m=new l;async function f(e){let r=e.get("email"),t=e.get("password");try{let e=await m.findByEmail(r);if(!e||e.password!==t)return{error:"이메일 또는 비밀번호가 올바르지 않습니다."};return(await (0,c.UL)()).set({name:"userId",value:e.id,httpOnly:!0,maxAge:604800,path:"/"}),{success:!0}}catch(e){return console.error("Login error:",e),{error:"로그인 중 오류가 발생했습니다."}}}async function p(){(await (0,c.UL)()).delete("userId"),(0,o.redirect)("/login")}async function y(){let e=await (0,c.UL)(),r=e.get("userId")?.value;return r?m.findById(r):null}async function w(){let e=await (0,c.UL)(),r=e.get("userId")?.value;return r?await m.getPlanColumnOrder(r):[]}async function h(){let e=await (0,c.UL)(),r=e.get("userId")?.value;return r?await m.getShipmentColumnOrder(r):[]}async function g(e){let r=await (0,c.UL)(),t=r.get("userId")?.value;if(!t)return{error:"로그인이 필요합니다."};try{return await m.updatePlanColumnOrder(t,JSON.stringify(e)),(0,a.revalidatePath)("/"),{success:!0}}catch(e){return console.error("컬럼 순서 저장 오류:",e),{error:"컬럼 순서를 저장하는 중 오류가 발생했습니다."}}}async function b(e){let r=await (0,c.UL)(),t=r.get("userId")?.value;if(!t)return{error:"로그인이 필요합니다."};try{return await m.updateShipmentColumnOrder(t,JSON.stringify(e)),(0,a.revalidatePath)("/"),{success:!0}}catch(e){return console.error("컬럼 순서 저장 오류:",e),{error:"컬럼 순서를 저장하는 중 오류가 발생했습니다."}}}(0,d.D)([f,p,y,w,h,g,b]),(0,n.A)(f,"40936ad88e3f1a4fa4fe1c0dd6aec3e2d65e62a0c1",null),(0,n.A)(p,"0003009d873d621b767ebfb709789f648c231c485b",null),(0,n.A)(y,"0028b4c78e95647dc5a53ee5fba9631161871c02cb",null),(0,n.A)(w,"003fa9301003c8ba05a336e03f03866e45be449bd6",null),(0,n.A)(h,"0030665d1c07fcb4de0143ec72ae810e2dc9ce96e5",null),(0,n.A)(g,"4023a82c0377ba75765752ff21005200097bd8ec35",null),(0,n.A)(b,"404757e7a76cb9b03e2ba3b2fa52f1184db3542cd1",null)},46516:(e,r,t)=>{t.d(r,{FZ:()=>l,Fq:()=>s,K4:()=>m,U0:()=>d,cg:()=>u});var n=t(17464);t(55414);var a=t(21316),c=t(10854),o=t(1634);let i=new a.Y;async function s(){try{return(await i.getAllImporters()).map(e=>({...e,importerCode:e.importerCode||"gompyo",calculationType:e.calculationType}))}catch(e){return console.error("수입업체 목록 조회 오류:",e),[]}}async function u(e){try{return(await i.searchImportersByName(e)).map(e=>({...e,importerCode:e.importerCode||"gompyo",calculationType:e.calculationType}))}catch(e){return console.error("수입업체 검색 오류:",e),[]}}async function l(e,r="gompyo",t=c.A.STANDARD){try{let n=await i.createImporter(e,r,t);if(!n)return null;return{...n,importerCode:n.importerCode||"gompyo",calculationType:n.calculationType}}catch(e){return console.error("수입업체 생성 오류:",e),null}}async function d(e,r){try{let t=await i.updateImporter(e,r);if(!t)return null;return{...t,importerCode:t.importerCode||"gompyo",calculationType:t.calculationType}}catch(e){return console.error("수입업체 업데이트 오류:",e),null}}async function m(e){try{return!!await i.deleteImporter(e)}catch(e){return console.error("수입업체 삭제 오류:",e),!1}}(0,o.D)([s,u,l,d,m]),(0,n.A)(s,"00c5a15d93ce2e21150395c1f1edf45fc13f09b740",null),(0,n.A)(u,"4026264675e76f121d3d849d280c288f690c0eda81",null),(0,n.A)(l,"708cad63520792ed7336398571bfb73e8af317b0f6",null),(0,n.A)(d,"6017f795efe87b4c75a171b6ea1256dc4a4761acb2",null),(0,n.A)(m,"40f435aa9d7067b612c2403439172f3ec34a342309",null)},70564:(e,r,t)=>{t.d(r,{y:()=>o});var n=t(13913),a=t(8613),c=t(98149);class o{async create(e){let[r]=await n.db.insert(a.contracts).values(e).returning();return r}async findById(e){let[r]=await n.db.select().from(a.contracts).where((0,c.eq)(a.contracts.id,e));return r}async findAll(){return await n.db.select().from(a.contracts)}async findByImporterId(e){return await n.db.select().from(a.contracts).where((0,c.eq)(a.contracts.importerId,e))}async update(e,r){let[t]=await n.db.update(a.contracts).set(r).where((0,c.eq)(a.contracts.id,e)).returning();return t}async delete(e){let[r]=await n.db.delete(a.contracts).where((0,c.eq)(a.contracts.id,e)).returning();return r}}},75762:(e,r,t)=>{t.d(r,{F:()=>a});var n=t(63016);let a=(0,n.createServerReference)("00c5a15d93ce2e21150395c1f1edf45fc13f09b740",n.callServer,void 0,n.findSourceMapURL,"getAllImporters")}};
