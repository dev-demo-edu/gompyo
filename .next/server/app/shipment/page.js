(()=>{var e={};e.id=1,e.ids=[1],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15467:(e,t,r)=>{"use strict";r.d(t,{default:()=>C});var a=r(11432),i=r(82472),n=r(20245),d=r(2494),o=r(74247),s=r(25867),l=r(45613),c=r(32246),u=r(90714);let m=(0,u.eU)([]),p=(0,u.eU)(0);function h({open:e,onClose:t}){let r=(0,c.md)(m),u=(0,c.Xr)(p);async function h(){console.log(r),await (0,l.w)(r.map(e=>e.id)),u(e=>e+1),t()}return(0,a.jsxs)(i.A,{open:e,onClose:t,maxWidth:"xs",fullWidth:!0,children:[(0,a.jsx)(n.A,{children:"화물 삭제 확인"}),(0,a.jsx)(d.A,{sx:{py:3},children:"정말로 선택한 화물을 삭제하시겠습니까?"}),(0,a.jsxs)(o.A,{sx:{px:3,pb:2,pt:0,justifyContent:"flex-end"},children:[(0,a.jsx)(s.A,{variant:"outlined",color:"primary",onClick:t,children:"취소"}),(0,a.jsx)(s.A,{variant:"contained",color:"primary",onClick:h,children:"삭제"})]})]})}var f=r(11417),g=r(29732),y=r(95093),w=r(63016);w.callServer,w.findSourceMapURL;let b=(0,w.createServerReference)("404757e7a76cb9b03e2ba3b2fa52f1184db3542cd1",w.callServer,void 0,w.findSourceMapURL,"saveUserShipmentColumnOrder");w.callServer,w.findSourceMapURL;var v=r(53295),x=r(61839);function N(){let[e,t]=(0,f.useState)([]),[r,i]=(0,f.useState)([]),[n,d]=(0,f.useState)(!0),[o,s]=(0,f.useState)(null),l=(0,f.useMemo)(()=>(console.log("columnOrder",r),[{headerName:"",checkboxSelection:!0,minWidth:50,flex:1,headerCheckboxSelection:!0,filter:!1,pinned:"left",lockPinned:!0,width:70,field:"checkbox"},...r.length>0?r.map(({field:e,width:t})=>{let r=x.cX.find(t=>t.field===e);return r?(r.width=t,r):(console.warn(`Column ${e} not found in DEFAULT_SHIPMENT_COLUMN`),null)}).filter(e=>null!==e):x.cX,{headerName:"상세",field:"detail",cellRenderer:y.t,sortable:!1,filter:!1,width:100,pinned:"right",lockPinned:!1}]),[r]),u=(0,f.useCallback)(async e=>{let t=e.api.getColumnState().filter(e=>"detail"!==e.colId).map(e=>({field:e.colId,width:e.width}));try{let e=await b(t);console.log("Column order save result:",e),e.success&&i(t)}catch(e){console.error("컬럼 순서 저장 중 오류:",e)}},[]),h=(0,f.useCallback)(async()=>{try{(await b(x.FX)).success&&i(x.FX)}catch(e){console.error("컬럼 순서 리셋 중 오류:",e)}},[]),{onDragStarted:w,onDragStopped:N}=(0,v.A)(u);(0,c.md)(p);let P=(0,c.Xr)(m),C=(0,f.useCallback)(e=>{P(e.api.getSelectedRows())},[P]);return(0,a.jsx)(g.A,{columnDefs:l,data:e,loading:n,error:o,onDragStarted:w,onDragStopped:N,onResetColumnOrder:h,searchDateField:"contractDate",onSelectionChanged:C})}var P=r(82423);function C(){let[e,t]=(0,f.useState)(!1),r=(0,c.md)(m);return(0,a.jsx)("div",{className:"w-full min-h-screen bg-gray-100",children:(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"선적 현황"}),(0,a.jsx)(P.A,{direction:"row",spacing:2,className:"w-full justify-end mb-4 sm:mb-6",children:(0,a.jsx)(s.A,{variant:"contained",onClick:()=>t(!0),disabled:0===r.length,className:"px-4 py-2 bg-primary-main text-white rounded-lg hover:bg-primary-dark transition-colors",children:"삭제하기"})}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)(N,{})}),(0,a.jsx)(h,{open:e,onClose:()=>t(!1)})]})})}},16659:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(10674),i=r(36701);function n(){return(0,a.jsx)(i.default,{})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},36405:(e,t,r)=>{"use strict";r.d(t,{wz:()=>f,Dm:()=>g,OA:()=>y,Lx:()=>p,y4:()=>h,Mo:()=>w,Fq:()=>b});var a=r(17464);r(55414);var i=r(19541),n=r(14567),d=r(15198),o=r(13913),s=r(8613),l=r(98149);class c{async findByEmail(e){let[t]=await o.db.select().from(s.users).where((0,l.eq)(s.users.email,e));return t}async findById(e){let[t]=await o.db.select().from(s.users).where((0,l.eq)(s.users.id,e));return t}async getPlanColumnOrder(e){let t=await this.findById(e);return t.planColumnOrder?JSON.parse(t.planColumnOrder):null}async getShipmentColumnOrder(e){let t=await this.findById(e);return t.shipmentColumnOrder?JSON.parse(t.shipmentColumnOrder):null}async updatePlanColumnOrder(e,t){let[r]=await o.db.update(s.users).set({planColumnOrder:t}).where((0,l.eq)(s.users.id,e)).returning();return r}async updateShipmentColumnOrder(e,t){let[r]=await o.db.update(s.users).set({shipmentColumnOrder:t}).where((0,l.eq)(s.users.id,e)).returning();return r}async create(e){let[t]=await o.db.insert(s.users).values(e).returning();return t}async delete(e){return await o.db.delete(s.users).where((0,l.eq)(s.users.id,e)),!0}}var u=r(1634);let m=new c;async function p(e){let t=e.get("email"),r=e.get("password");try{let e=await m.findByEmail(t);if(!e||e.password!==r)return{error:"이메일 또는 비밀번호가 올바르지 않습니다."};return(await (0,n.UL)()).set({name:"userId",value:e.id,httpOnly:!0,maxAge:604800,path:"/"}),{success:!0}}catch(e){return console.error("Login error:",e),{error:"로그인 중 오류가 발생했습니다."}}}async function h(){(await (0,n.UL)()).delete("userId"),(0,d.redirect)("/login")}async function f(){let e=await (0,n.UL)(),t=e.get("userId")?.value;return t?m.findById(t):null}async function g(){let e=await (0,n.UL)(),t=e.get("userId")?.value;return t?await m.getPlanColumnOrder(t):[]}async function y(){let e=await (0,n.UL)(),t=e.get("userId")?.value;return t?await m.getShipmentColumnOrder(t):[]}async function w(e){let t=await (0,n.UL)(),r=t.get("userId")?.value;if(!r)return{error:"로그인이 필요합니다."};try{return await m.updatePlanColumnOrder(r,JSON.stringify(e)),(0,i.revalidatePath)("/"),{success:!0}}catch(e){return console.error("컬럼 순서 저장 오류:",e),{error:"컬럼 순서를 저장하는 중 오류가 발생했습니다."}}}async function b(e){let t=await (0,n.UL)(),r=t.get("userId")?.value;if(!r)return{error:"로그인이 필요합니다."};try{return await m.updateShipmentColumnOrder(r,JSON.stringify(e)),(0,i.revalidatePath)("/"),{success:!0}}catch(e){return console.error("컬럼 순서 저장 오류:",e),{error:"컬럼 순서를 저장하는 중 오류가 발생했습니다."}}}(0,u.D)([p,h,f,g,y,w,b]),(0,a.A)(p,"40936ad88e3f1a4fa4fe1c0dd6aec3e2d65e62a0c1",null),(0,a.A)(h,"0003009d873d621b767ebfb709789f648c231c485b",null),(0,a.A)(f,"0028b4c78e95647dc5a53ee5fba9631161871c02cb",null),(0,a.A)(g,"003fa9301003c8ba05a336e03f03866e45be449bd6",null),(0,a.A)(y,"0030665d1c07fcb4de0143ec72ae810e2dc9ce96e5",null),(0,a.A)(w,"4023a82c0377ba75765752ff21005200097bd8ec35",null),(0,a.A)(b,"404757e7a76cb9b03e2ba3b2fa52f1184db3542cd1",null)},36701:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});let a=(0,r(73602).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/kang-yean-woo/gompyo/src/containers/shipment/shipment.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/kang-yean-woo/gompyo/src/containers/shipment/shipment.tsx","default")},38777:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"0003009d873d621b767ebfb709789f648c231c485b":()=>c.y4,"0028b4c78e95647dc5a53ee5fba9631161871c02cb":()=>c.wz,"0030665d1c07fcb4de0143ec72ae810e2dc9ce96e5":()=>c.OA,"003fa9301003c8ba05a336e03f03866e45be449bd6":()=>c.Dm,"0049339fb493948c1ac1860dd2eac9b3f1836c541e":()=>l,"0056514906622dc5d1f36400c763a82f1feea6dea8":()=>a.op,"4023a82c0377ba75765752ff21005200097bd8ec35":()=>c.Mo,"404757e7a76cb9b03e2ba3b2fa52f1184db3542cd1":()=>c.Fq,"406ae734aa33a7d3bd51f01bfc3806dd08d1688a7a":()=>a.ws,"40936ad88e3f1a4fa4fe1c0dd6aec3e2d65e62a0c1":()=>c.Lx,"60aad6fa22992cc57a523c0a16b305f260de2e2e48":()=>a.qT});var a=r(18971),i=r(17464);r(55414);var n=r(13913),d=r(70954),o=r(10854),s=r(73103);async function l(){return(await n.db.query.cargos.findMany({with:{item:!0,shipment:{with:{contract:{with:{importer:!0,payments:{with:{paymentsTt:!0}}}}}},costs:{with:{costDetails:!0}}},orderBy:(e,{desc:t})=>[t(e.createdAt)]})).map(e=>{let t=e.item,r=e.shipment,a=r?.contract,i=a?.importer,n=a?.payments?.[0],l=n?.paymentsTt,c=e.costs?.[0],u=c?.costDetails?.[0],m={contract:{id:a?.id||"",contractNumber:a?.contractNumber||"",contractDate:a?.contractDate||"",exporter:a?.exporter||"",importerId:a?.importerId||"",incoterms:a?.incoterms||"",createdAt:a?.createdAt||"",updatedAt:a?.updatedAt||""},shipment:{id:r?.id||"",contractId:a?.id||"",estimatedTimeDeparture:r?.estimatedTimeDeparture||"",estimatedTimeArrival:r?.estimatedTimeArrival||"",shippingCompany:r?.shippingCompany||"",departurePort:r?.departurePort||"",arrivalPort:r?.arrivalPort||"",blNumber:r?.blNumber||"",palletOrderDate:r?.palletOrderDate||"",palletType:r?.palletType||"",createdAt:r?.createdAt||"",updatedAt:r?.updatedAt||""},cargo:{id:e?.id||"",remark:e?.remark||"",itemsId:e?.itemsId||"",shipmentId:r?.id||"",containerCount:e?.containerCount||0,contractTon:e?.contractTon||0,progressStatus:e?.progressStatus||"예정",customsClearanceDate:e?.customsClearanceDate||"",quarantineDate:e?.quarantineDate||"",warehouseEntryDate:e?.warehouseEntryDate||"",sellingPrice:e?.sellingPrice||0,margin:e?.margin||0,totalProfit:e?.totalProfit||0,purchaseFeeRate:e?.purchaseFeeRate||0,sellingPriceWholesale:e?.sellingPriceWholesale||0,sellingPriceRetail:e?.sellingPriceRetail||0,createdAt:e?.createdAt||"",updatedAt:e?.updatedAt||""},cost:{id:c?.id||"",cargoId:e?.id||"",supplyPrice:c?.supplyPrice||0,shippingCost:c?.shippingCost||0,laborCost:c?.laborCost||0,transportStorageFee:c?.transportStorageFee||0,loadingUnloadingFee:c?.loadingUnloadingFee||0,usanceInterest:c?.usanceInterest||0,gompyoLaborCost:c?.gompyoLaborCost||0,gompyoTransportStorageFee:c?.gompyoTransportStorageFee||0,gompyoLoadingUnloadingFee:c?.gompyoLoadingUnloadingFee||0},costDetail:{id:u?.id||"",costId:c?.id||"",unitPrice:u?.unitPrice||0,exchangeRate:u?.exchangeRate||0,customsTaxRate:u?.customsTaxRate||0,customsFee:u?.customsFee||0,inspectionFee:u?.inspectionFee||0,doCharge:u?.doCharge||0,otherCosts:u?.otherCosts||0,transferFee:u?.transferFee||0},payment:{id:n?.id||"",contractId:a?.id||"",paymentMethod:n?.paymentMethod||"",paymentDueDate:n?.paymentDueDate||"",advancePaymentDate:l?.advancePaymentDate||"",advancePaymentRatio:l?.advancePaymentRatio||0,remainingPaymentDate:l?.remainingPaymentDate||"",remainingPaymentRatio:l?.remainingPaymentRatio||0,counterpartBank:l?.counterpartBank||"",paymentTerm:""},item:{id:t?.id||"",itemName:t?.itemName||"",itemVariety:t?.itemVariety||"",packingUnit:t?.packingUnit||"",originCountry:t?.originCountry||"",hsCode:t?.hsCode||""},importer:{id:i?.id||"",importerName:i?.importerName||"",importerCode:i?.importerCode||"gompyo",calculationType:i?.calculationType||o.A.STANDARD}},p=(0,d.s)(m);return{id:e?.id||"",contractNumber:a?.contractNumber||"",progressStatus:s.LE[e?.progressStatus]||"예정",contractDate:a?.contractDate||"",importer:i?.importerName||"",productName:t?.itemVariety||"",itemName:t?.itemName||"",weight:e?.contractTon||0,containerCount:e?.containerCount||0,packagingUnit:t?.packingUnit||"",unitPrice:p.costDetail.unitPrice||0,totalPrice:p.costDetail.totalContractPrice||0,supplyPrice:p.cost.supplyPrice||0,sellingPrice:p.cargo.sellingPrice||0,paymentMethod:n?.paymentMethod||"",hsCode:t?.hsCode||"",blNumber:r?.blNumber||"",departurePort:r?.departurePort||"",etd:r?.estimatedTimeDeparture||"",arrivalPort:r?.arrivalPort||"",eta:r?.estimatedTimeArrival||"",exporter:a?.exporter||"",customsDate:e?.customsClearanceDate||"",packingUnit:t?.packingUnit||""}})}(0,r(1634).D)([l]),(0,i.A)(l,"0049339fb493948c1ac1860dd2eac9b3f1836c541e",null);var c=r(36405)},45613:(e,t,r)=>{"use strict";r.d(t,{w:()=>i});var a=r(63016);let i=(0,a.createServerReference)("406ae734aa33a7d3bd51f01bfc3806dd08d1688a7a",a.callServer,void 0,a.findSourceMapURL,"deletePlans")},53295:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(11417);let i=function(e){let t=(0,a.useRef)([]);return{onDragStarted:e=>{t.current=e.api.getColumnState().map(e=>e.colId)},onDragStopped:r=>{let a=r.api.getColumnState().map(e=>e.colId).filter(e=>"detail"!==e);t.current.every((e,t)=>e===a[t])||e(r)}}}},56964:(e,t,r)=>{Promise.resolve().then(r.bind(r,36701))},61839:(e,t,r)=>{"use strict";r.d(t,{FX:()=>o,cX:()=>n,mg:()=>d,zG:()=>i});var a=r(42623);let i=[{field:"contractNumber",headerName:"계약 번호",width:130},{field:"progressStatus",headerName:"진행 상태",width:100},{field:"contractDate",headerName:"계약일자",valueFormatter:a.Kg,width:150},{field:"exporter",headerName:"공급업체",width:120},{field:"importer",headerName:"수입회사",width:120},{field:"estimatedTimeArrival",headerName:"ETA",valueFormatter:a.Kg,width:150},{field:"arrivalPort",headerName:"도착항",width:120},{field:"itemName",headerName:"품목",width:120},{field:"contractTon",headerName:"무게",valueFormatter:e=>`${e.value}톤`,width:100},{field:"packingUnit",headerName:"포장 단위",width:130},{field:"unitPrice",headerName:"단가",valueFormatter:a.sg,width:130},{field:"totalPrice",headerName:"단가 * 무게",valueFormatter:a.ye,width:150},{field:"paymentMethod",headerName:"결제방식",width:100},{field:"warehouseEntryDate",headerName:"입고일",valueFormatter:a.Kg,width:150},{field:"importCostPerKg",headerName:"수입가/kg",valueFormatter:a.gt,width:130},{field:"supplyCostPerKg",headerName:"수급가/kg",valueFormatter:a.gt,width:130},{field:"totalCost",headerName:"총 비용",valueFormatter:a.ye,width:150},{field:"totalCostPerKg",headerName:"총 비용/kg",valueFormatter:a.gt,width:130},{field:"sellingPrice",headerName:"판매가",valueFormatter:a.ye,width:130},{field:"margin",headerName:"마진",valueFormatter:a.ye,width:100},{field:"totalProfit",headerName:"총 이익",valueFormatter:a.ye,width:150}],n=[{field:"contractNumber",headerName:"계약 번호",width:130},{field:"progressStatus",headerName:"진행 상태",width:100},{field:"contractDate",headerName:"계약일자",valueFormatter:a.Kg,width:150},{field:"importer",headerName:"수입회사",width:120},{field:"productName",headerName:"품종",width:150},{field:"itemName",headerName:"품목",width:120},{field:"weight",headerName:"무게",valueFormatter:e=>`${e.value}톤`,width:100},{field:"containerCount",headerName:"컨테이너 개수",width:120},{field:"packingUnit",headerName:"포장 단위",width:100},{field:"unitPrice",headerName:"단가",valueFormatter:a.sg,width:130},{field:"totalPrice",headerName:"단가 * 무게",valueFormatter:a.ye,width:150},{field:"supplyPrice",headerName:"수급가",valueFormatter:a.ye,width:130},{field:"sellingPrice",headerName:"판매가",valueFormatter:a.ye,width:130},{field:"paymentMethod",headerName:"결제방식",width:100},{field:"hsCode",headerName:"HS CODE",width:120},{field:"blNumber",headerName:"BL no.",width:120},{field:"departurePort",headerName:"port(출발항)",width:120},{field:"etd",headerName:"ETD",valueFormatter:a.Kg,width:150},{field:"arrivalPort",headerName:"port(도착항)",width:120},{field:"eta",headerName:"ETA",valueFormatter:a.Kg,width:150},{field:"exporter",headerName:"공급업체",width:120},{field:"customsDate",headerName:"통관일자",valueFormatter:a.Kg,width:150}],d=i.map(e=>({field:e.field,width:e.width||100})),o=n.map(e=>({field:e.field,width:e.width||100}))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},77219:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>d.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l});var a=r(65282),i=r(20277),n=r(47757),d=r.n(n),o=r(96002),s={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>o[e]);r.d(t,s);let l={children:["",{children:["shipment",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,16659)),"/Users/kang-yean-woo/gompyo/src/app/shipment/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,34421))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,98445)),"/Users/kang-yean-woo/gompyo/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,24327)),"/Users/kang-yean-woo/gompyo/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,68366,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,75895,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,34421))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/kang-yean-woo/gompyo/src/app/shipment/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/shipment/page",pathname:"/shipment",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},77598:e=>{"use strict";e.exports=require("node:crypto")},79551:e=>{"use strict";e.exports=require("url")},87550:e=>{"use strict";e.exports=require("better-sqlite3")},93764:(e,t,r)=>{Promise.resolve().then(r.bind(r,15467))},95093:(e,t,r)=>{"use strict";r.d(t,{t:()=>d});var a=r(11432),i=r(71251),n=r.n(i);let d=e=>(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(n(),{href:`/detail/${e.data.id}`,className:"inline-block px-4 py-1.5 bg-[#22C55E] text-white rounded-lg hover:bg-[#16A34A] transition-colors text-sm font-medium text-center",children:"상세보기"})})}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[883,873,91,335,560,246,541,548,547,913,362,971],()=>r(77219));module.exports=a})();
