(()=>{var e={};e.id=884,e.ids=[884],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9367:(e,a,t)=>{"use strict";t.d(a,{default:()=>r});let r=(0,t(73602).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/kang-yean-woo/gompyo/src/containers/cashflow/cashflow.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/kang-yean-woo/gompyo/src/containers/cashflow/cashflow.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14368:(e,a,t)=>{"use strict";t.d(a,{A:()=>w});var r=t(11432),n=t(11417),l=t.n(n),o=t(82423),i=t(36),s=t(96984),d=t(52510),c=t(64655),u=t(47338),f=t(1836),m=t(84245),p=t(34294),h=t(4105),b=t(25867),x=t(92711),y=t(66778);function g(e){return e.reduce((e,a)=>{let t;return t="array"===a.type?a.defaultValue??[]:"select"===a.type&&a.options&&a.options.length>0?a.defaultValue??a.options[0].value:a.defaultValue??"",{...e,[a.name]:t}},{})}function w({zodSchema:e,steps:a,fields:t,onSubmit:w,submitLabel:v="저장",zodSchemas:A,onCancel:j,fieldErrors:S={},initialValues:C={}}){let k=!!a,[N,R]=(0,n.useState)(0),z=k?a[N].fields:t,[I,W]=(0,n.useState)(k?{...a.reduce((e,a)=>({...e,...g(a.fields)}),{}),...C}:{...g(t),...C}),[q,E]=(0,n.useState)({}),[M,P]=(0,n.useState)(!1),D=(e,a)=>{W(t=>({...t,[e]:a}))},H=e=>{W(a=>({...a,[e.name]:[...Array.isArray(a[e.name])?a[e.name]:[],g(e.fields)]}))},U=(e,a)=>{W(t=>({...t,[e.name]:Array.isArray(t[e.name])?t[e.name].filter((e,t)=>t!==a):[]}))},B=(e,a,t,r)=>{W(n=>({...n,[e.name]:Array.isArray(n[e.name])?n[e.name].map((e,n)=>n===a?{...e,[t]:r}:e):[]}))},_=e=>{let a={};return e.errors.forEach(e=>{a[e.path[0]]=e.message}),a},F=async t=>{let r;if(!M){if(t.preventDefault(),(r=k&&A?A[N].safeParse(I):e?e.safeParse(I):{success:!0,data:I})&&!r.success){E(_(r.error));return}E({}),P(!0);try{k&&N<a.length-1?R(e=>e+1):await w(I)}finally{P(!1)}}},L=(e,a,t,n,b)=>{let g=S[e.name]||n;switch(e.type){case"text":case"number":case"date":return(0,r.jsx)(i.A,{label:e.label,name:e.name,type:"number"===e.type?"number":e.type,value:a,onChange:a=>t("number"===e.type?Number(a.target.value):a.target.value),fullWidth:!0,error:!!g,helperText:g||e.helperText,InputLabelProps:"date"===e.type?{shrink:!0}:void 0,InputProps:e.endAdornment?{endAdornment:(0,r.jsx)(s.A,{sx:{color:"inherit","& .MuiTypography-root":{color:"inherit"}},position:"end",children:e.endAdornment})}:void 0,sx:{mb:1}},e.name+(b??""));case"select":return(0,r.jsxs)(d.A,{fullWidth:!0,error:!!g,sx:{mb:1},children:[(0,r.jsx)(c.A,{children:e.label}),(0,r.jsx)(u.A,{value:a,label:e.label,onChange:e=>t(e.target.value),children:e.options?.map(e=>r.jsx(f.A,{value:e.value,children:e.label},e.value))}),g&&(0,r.jsx)(m.A,{color:"error",variant:"caption",children:g})]},e.name+(b??""));case"array":return(0,r.jsxs)(p.A,{sx:{mb:2},children:[(0,r.jsxs)(p.A,{display:"flex",alignItems:"center",mb:1,children:[(0,r.jsx)(m.A,{variant:"subtitle1",children:e.label}),(0,r.jsx)(h.A,{size:"small",onClick:()=>H(e),sx:{ml:1},children:(0,r.jsx)(x.A,{fontSize:"small"})})]}),(Array.isArray(a)?a:[]).map((a,t)=>(0,r.jsxs)(p.A,{sx:{border:"1px solid #eee",borderRadius:1,p:2,mb:1},children:[(0,r.jsxs)(p.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,r.jsxs)(m.A,{variant:"body2",children:[e.label," #",t+1]}),(0,r.jsx)(h.A,{size:"small",onClick:()=>U(e,t),children:(0,r.jsx)(y.A,{fontSize:"small"})})]}),function({field:e,item:a,onChange:t,errors:n}){return(0,r.jsx)(o.A,{spacing:1,mt:1,children:e.fields?.map(e=>{let o=a[e.name];return r.jsx(l().Fragment,{children:(()=>{switch(e.type){case"text":case"number":case"date":return r.jsx(i.A,{label:e.label,name:e.name,type:"number"===e.type?"number":e.type,value:o,onChange:a=>t(e.name,"number"===e.type?Number(a.target.value):a.target.value),fullWidth:!0,error:!!n[e.name],helperText:n[e.name]||e.helperText,InputLabelProps:"date"===e.type?{shrink:!0}:void 0,InputProps:e.endAdornment?{endAdornment:r.jsx(s.A,{sx:{color:"inherit","& .MuiTypography-root":{color:"inherit"}},position:"end",children:e.endAdornment})}:void 0,sx:{mb:1}});case"select":return r.jsxs(d.A,{fullWidth:!0,error:!!n[e.name],sx:{mb:1},children:[r.jsx(c.A,{children:e.label}),r.jsx(u.A,{value:o,label:e.label,onChange:a=>t(e.name,a.target.value),children:e.options?.map(e=>r.jsx(f.A,{value:e.value,children:e.label},e.value))}),n[e.name]&&r.jsx(m.A,{color:"error",variant:"caption",children:n[e.name]})]});case"custom":return e.render?e.render({value:o,onChange:a=>t(e.name,a),error:n[e.name]}):null;default:return null}})()},e.name)})})}({field:e,item:a,onChange:(a,r)=>B(e,t,a,r),errors:{}})]},t))]},e.name);case"custom":return e.render?e.render({value:a,onChange:t,error:g}):null;default:return null}};return(0,r.jsxs)("form",{onSubmit:F,children:[k&&(0,r.jsx)(m.A,{variant:"h6",sx:{mb:2},children:a[N].label}),(0,r.jsx)(o.A,{spacing:2,sx:{mt:1},children:z.map(e=>L(e,I[e.name],a=>D(e.name,a),q[e.name]))}),(0,r.jsxs)(p.A,{display:"flex",flexDirection:"row",justifyContent:"flex-end",gap:2,mt:2,children:[k&&N>0&&(0,r.jsx)(b.A,{variant:"outlined",color:"primary",onClick:()=>R(e=>e-1),children:"이전"}),"function"==typeof j&&(0,r.jsx)(b.A,{variant:"outlined",color:"primary",onClick:j,children:"취소"}),(0,r.jsx)(b.A,{type:"submit",variant:"contained",color:"primary",sx:{fontWeight:600},disabled:M,children:k&&N<a.length-1?"다음":v})]})]})}},16860:(e,a,t)=>{"use strict";t.r(a),t.d(a,{"002c2a995316899370823c114387b80aa461c8570a":()=>u,"006046c9171b353e09b11860b24d61dce0207bcf3d":()=>d,"0064d0aa3dc73d3e2347c6788d7a0706225c32ca28":()=>y,"4010ebbb2ada859a9a04e73783a3e040809561f3d7":()=>f,"4018548b40aee4bb321a420e32f5d54182228e1031":()=>c,"405fe64f045f09ca351996860617c6ca7e03857753":()=>p,"406526e0cfbfd72f74824bc972e4ce73f14185b4a5":()=>m,"40ae6f6fe96e4e4dedaa75b8341c33379082165201":()=>x,"40fbc5b244afe76bd5ed863542e5546ccee61b9adf":()=>h,"6044a60bb253633318b81ddcf73aa28c0e2571fd55":()=>g,"6082533c7e46b51ebec4b6e1891b6b25b350697515":()=>b});var r=t(17464);t(55414);var n=t(13913),l=t(8613),o=t(18591),i=t(98149),s=t(26763);async function d(){return await n.db.select().from(l.cashflows).orderBy((0,o.Y)(l.cashflows.date),(0,o.Y)(l.cashflows.priority))}async function c(e){return(await n.db.select().from(l.cashflows).where((0,i.eq)(l.cashflows.id,e)))[0]}async function u(){return await n.db.select().from(l.companies).orderBy((0,o.Y)(l.companies.name))}async function f(e){let a=await n.db.select().from(l.cashflows).where((0,i.Uo)((0,i.eq)(l.cashflows.date,e.date),(0,i.eq)(l.cashflows.type,e.type),(0,i.eq)(l.cashflows.companyId,e.companyId))),t=null;return a.length+1}async function m(e){let a=await f(e);return await n.db.insert(l.cashflows).values({...e,id:(0,s.Ak)(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),priority:a})}async function p(e){let a=await n.db.delete(l.cashflows).where((0,i.RV)(l.cashflows.id,e));return await y(),a}async function h(e){for(let a of e)await n.db.update(l.cashflows).set({priority:a.priority}).where((0,i.eq)(l.cashflows.id,a.id))}async function b(e,a){return await n.db.update(l.companies).set({companyBalance:e}).where((0,i.eq)(l.companies.id,a))}async function x(e){let a=await n.db.select().from(l.cashflows).where((0,i.Uo)((0,i.eq)(l.cashflows.date,e.date),(0,i.eq)(l.cashflows.type,e.type),(0,i.eq)(l.cashflows.companyId,e.companyId))).orderBy((0,o.Y)(l.cashflows.priority));for(let e=0;e<a.length;e++)await n.db.update(l.cashflows).set({priority:e+1}).where((0,i.eq)(l.cashflows.id,a[e].id))}async function y(){let e=await n.db.select().from(l.cashflows),a=new Map;for(let t of e){let e=`${t.companyId}_${t.type}_${t.date}`;a.has(e)||a.set(e,[]),a.get(e).push(t)}for(let e of a.values()){e.sort((e,a)=>(e.priority??0)-(a.priority??0));for(let a=0;a<e.length;a++)await n.db.update(l.cashflows).set({priority:a+1}).where((0,i.eq)(l.cashflows.id,e[a].id))}}async function g(e,a){let t=await c(a),r=t?.type!==e.type,o=t?.date!==e.date,s=t?.priority;return(r||o)&&(s=await f(e)),await n.db.update(l.cashflows).set({...e,priority:s,updatedAt:new Date().toISOString()}).where((0,i.eq)(l.cashflows.id,a)),t&&(r||o)&&(await x(t),await x(e)),await n.db.select().from(l.cashflows).where((0,i.eq)(l.cashflows.id,a)).then(e=>e[0])}(0,t(1634).D)([d,c,u,f,m,p,h,b,x,y,g]),(0,r.A)(d,"006046c9171b353e09b11860b24d61dce0207bcf3d",null),(0,r.A)(c,"4018548b40aee4bb321a420e32f5d54182228e1031",null),(0,r.A)(u,"002c2a995316899370823c114387b80aa461c8570a",null),(0,r.A)(f,"4010ebbb2ada859a9a04e73783a3e040809561f3d7",null),(0,r.A)(m,"406526e0cfbfd72f74824bc972e4ce73f14185b4a5",null),(0,r.A)(p,"405fe64f045f09ca351996860617c6ca7e03857753",null),(0,r.A)(h,"40fbc5b244afe76bd5ed863542e5546ccee61b9adf",null),(0,r.A)(b,"6082533c7e46b51ebec4b6e1891b6b25b350697515",null),(0,r.A)(x,"40ae6f6fe96e4e4dedaa75b8341c33379082165201",null),(0,r.A)(y,"0064d0aa3dc73d3e2347c6788d7a0706225c32ca28",null),(0,r.A)(g,"6044a60bb253633318b81ddcf73aa28c0e2571fd55",null)},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},42623:(e,a,t)=>{"use strict";t.d(a,{R8:()=>r,eg:()=>i,f3:()=>o,gt:()=>l,ye:()=>n});let r=e=>e.value?new Date(e.value).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"",n=e=>e.value?new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW"}).format(e.value):"",l=e=>e.value?new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(e.value)+"/kg":"",o=e=>e.value?new Date(e.value).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"}):"",i=e=>{if(null===e.value||void 0===e.value||""===e.value)return"";let a=Number(e.value);if(isNaN(a))return"";let t=Number(a.toFixed(1));return Number.isInteger(t)?t.toString():t.toFixed(1)}},45786:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l});var r=t(10674),n=t(9367);function l(){return(0,r.jsx)(n.default,{})}},53341:(e,a,t)=>{"use strict";t.d(a,{A:()=>d});var r=t(11432),n=t(11417),l=t(26093),o=t(38762),i=t(98194),s=t(29871);function d({columnDefs:e,data:a,loading:t=!1,error:i=null,onDragStarted:d,onDragStopped:c,onSelectionChanged:u,pagination:f=!0,paginationPageSize:m=15,onRowDragEnd:p}){let h=(0,n.useRef)(null),b=(0,n.useMemo)(()=>({sortable:!0,resizable:!0,minWidth:100,filter:!0,lockPinned:!0}),[]),x=(0,n.useMemo)(()=>e.filter(e=>e.field).map(e=>({colId:e.field,pinned:e.pinned,flex:e.flex,width:e.width,lockPinned:e.lockPinned})),[e]),y=(0,n.useMemo)(()=>o.z0,[]),g=(0,n.useCallback)(e=>{"checkbox"===e.colDef.field&&e.node.setSelected(!e.node.isSelected())},[]),w=(0,n.useCallback)(e=>{h.current=e.api,h.current?.applyColumnState({state:x,applyOrder:!0})},[x]);return i?(0,r.jsx)("div",{className:"w-full h-[800px] bg-white flex items-center justify-center overflow-y-auto",children:(0,r.jsx)("p",{className:"text-red-500",children:i})}):(0,r.jsx)("div",{className:"ag-theme-material w-full h-full bg-slate-50 rounded-xl overflow-hidden shadow-lg",children:t?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-[#22C55E] rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"w-3 h-3 bg-[#22C55E] rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,r.jsx)("div",{className:"w-3 h-3 bg-[#22C55E] rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})}):(0,r.jsx)("div",{className:"w-full h-full",children:(0,r.jsx)(l.W6,{theme:s.g,rowData:a,columnDefs:e,defaultColDef:b,pagination:f,paginationPageSize:m,rowSelection:"multiple",localeText:y,onDragStarted:d,onDragStopped:c,onGridReady:w,onSelectionChanged:u,rowDragManaged:!0,animateRows:!0,getRowId:e=>e.data.id,onRowDragEnd:p,suppressRowClickSelection:!0,onCellClicked:g})})})}i.syG.registerModules([i.JKr])},53686:(e,a,t)=>{Promise.resolve().then(t.bind(t,9367))},55983:(e,a,t)=>{"use strict";t.d(a,{default:()=>ee});var r=t(11432),n=t(25867),l=t(82423),o=t(53341),i=t(11417),s=t(32246),d=t(90714);let c=(0,d.eU)([]),u=(0,d.eU)(""),f=(0,d.eU)(e=>{let a=e(c),t=e(u);return a.filter(e=>e.companyId===t)}),m=(0,d.eU)(0),p=(0,d.eU)([]),h=(0,d.eU)([]),b=(0,d.eU)([]),x=(0,d.eU)(e=>{let a=e(u),t=e(p).find(e=>e.id===a);return t?.companyBalance??0}),y=(0,d.eU)(null,(e,a,t)=>{let r=e(u);a(p,e=>e.map(e=>e.id===r?{...e,companyBalance:t}:e))}),g=(0,d.eU)(!1);var w=t(84245),v=t(63016);let A=(0,v.createServerReference)("40fbc5b244afe76bd5ed863542e5546ccee61b9adf",v.callServer,void 0,v.findSourceMapURL,"updateCashflowPriorities");v.callServer,v.findSourceMapURL;var j=t(42623);function S(e,a){let t=a;return e.map(e=>(t+=e.amount,{...e,company:e.counterparty,total:t}))}function C(){let e=(0,s.md)(f);(0,s.md)(m);let a=(0,s.Xr)(c),t=(0,s.Xr)(h),n=(0,s.Xr)(b),l=(0,s.md)(x),d=(0,s.md)(g);(0,i.useRef)(null);let u=async t=>{let r=t.node.data.type,n=t.node.data.date,l=[];t.api.forEachNodeAfterFilterAndSort(e=>{let a=e.data;a.type===r&&a.date===n&&l.push(a)});let o=l.map((e,a)=>({...e,priority:l.length>1?a+1:null}));a([...e.filter(e=>e.date!==n||e.type!==r),...o].sort((e,a)=>"balance-row"===e.id?-1:"balance-row"===a.id?1:e.date.localeCompare(a.date))),await A(o)},p=async t=>{let r=[];t.api.forEachNodeAfterFilterAndSort(e=>{r.push(e.data)});let n={};r.forEach(e=>{let a=`${e.date}-${e.type}`;n[a]||(n[a]=[]),n[a].push(e)});let l=[];Object.values(n).forEach(e=>{let a=e.map((a,t)=>({...a,priority:e.length>1?t+1:null}));l.push(...a)}),a(e.filter(e=>!l.some(a=>a.id===e.id)).concat(l).sort((e,a)=>"balance-row"===e.id?-1:"balance-row"===a.id?1:e.date.localeCompare(a.date))),await A(l)},y=[{headerName:"",field:"dragHandle",width:70,minWidth:70,pinned:"left",lockPinned:!0,suppressMovable:!0,filter:!1,sortable:!1,rowDrag:e=>"balance-row"!==e.data.id,cellRenderer:()=>"",hide:!d,suppressHeaderMenuButton:!0},{headerName:"",checkboxSelection:e=>"balance-row"!==e.data.id,field:"checkbox",minWidth:50,flex:1,headerCheckboxSelection:!0,filter:!1,pinned:"left",lockPinned:!0,width:70,hide:d,suppressHeaderMenuButton:!0},{headerName:"날짜",field:"date",minWidth:150,flex:1,filter:!1,sortable:!1,valueFormatter:j.f3,suppressHeaderMenuButton:!0},{headerName:"업체",field:"company",minWidth:120,flex:1,filter:!1,sortable:!1,suppressHeaderMenuButton:!0},{headerName:"금액",field:"amount",minWidth:120,flex:1,filter:!1,sortable:!1,valueFormatter:j.eg,suppressHeaderMenuButton:!0},{headerName:"합계",field:"total",minWidth:120,flex:1,filter:!1,sortable:!1,valueFormatter:j.eg,suppressHeaderMenuButton:!0},{headerName:"우선순위",field:"priority",minWidth:120,flex:1,filter:!1,sortable:!1,cellRenderer:e=>{let{date:a,type:t}=e.data,r=[];return e.api.forEachNode(e=>{e.data&&"balance-row"!==e.data.id&&r.push(e.data)}),r.filter(e=>e.date===a&&e.type===t).length>1?e.value:""},suppressHeaderMenuButton:!0}],v=(0,i.useMemo)(()=>S(e.filter(e=>"expense"===e.type),0),[e]),C={id:"balance-row",date:"",companyId:"balance-row",amount:l,priority:null,type:"income",counterparty:"잔액",createdAt:"",updatedAt:""},k=(0,i.useMemo)(()=>S([C,...e].filter(e=>"income"===e.type),0),[e,l]);return(0,r.jsx)("div",{className:"h-[90vh] flex flex-col overflow-hidden ",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row w-full flex-1 gap-x-6 h-full",children:[(0,r.jsxs)("div",{className:"w-full h-full flex flex-col overflow-hidden",children:[(0,r.jsx)("div",{className:"flex flex-row justify-between h-[44px]",children:(0,r.jsx)(w.A,{className:"p-2",variant:"h6",children:"지출"})}),(0,r.jsx)("div",{style:{height:"100%",width:"100%"},children:(0,r.jsx)(o.A,{columnDefs:y,data:v,onSelectionChanged:e=>{t(e.api.getSelectedRows().filter(e=>"balance-row"!==e.id))},onRowDragEnd:u,onDragStopped:p,pagination:!1})})]}),(0,r.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"flex flex-row justify-between h-[44px]",children:[(0,r.jsx)(w.A,{className:"p-2",variant:"h6",children:"수금"}),(0,r.jsx)("div",{className:"flex flex-row justify-between",children:(0,r.jsx)(w.A,{className:"text-right font-extralight text-gray-500 pb-2 ",sx:{fontSize:"12px",verticalAlign:"bottom",display:"flex",alignItems:"flex-end"},children:"* 금액 단위: 100만원"})})]}),(0,r.jsx)("div",{style:{height:"100%",width:"100%"},children:(0,r.jsx)(o.A,{columnDefs:y,data:k,onSelectionChanged:e=>{n(e.api.getSelectedRows().filter(e=>"balance-row"!==e.id))},onRowDragEnd:u,onDragStopped:p,pagination:!1})})]})]})})}let k=(0,v.createServerReference)("002c2a995316899370823c114387b80aa461c8570a",v.callServer,void 0,v.findSourceMapURL,"getCompanyList"),N=(0,v.createServerReference)("6082533c7e46b51ebec4b6e1891b6b25b350697515",v.callServer,void 0,v.findSourceMapURL,"updateCompanyBalance"),R=(0,v.createServerReference)("405fe64f045f09ca351996860617c6ca7e03857753",v.callServer,void 0,v.findSourceMapURL,"deleteCashflows");var z=t(82472),I=t(20245),W=t(2494),q=t(74247),E=t(14368),M=t(68634);let P=(0,v.createServerReference)("406526e0cfbfd72f74824bc972e4ce73f14185b4a5",v.callServer,void 0,v.findSourceMapURL,"addCashflow"),D=M.z.string().superRefine((e,a)=>{let t=/^-?\d+(\.\d)?$/;if(isNaN(Number(e))){a.addIssue({code:M.z.ZodIssueCode.custom,message:"유효한 숫자여야 합니다."});return}if(/^-?\d+\.\d{2,}$/.test(e)){a.addIssue({code:M.z.ZodIssueCode.custom,message:"숫자는 소수점 한 자리까지만 입력 가능합니다."});return}if(/^[-+]?\d*(\.\d+)?([eE].+)?$/.test(e)&&!t.test(e)||!t.test(e)){a.addIssue({code:M.z.ZodIssueCode.custom,message:"유효한 숫자여야 합니다."});return}}).transform(e=>parseFloat(e)),H=M.z.string().superRefine((e,a)=>{let t=!isNaN(Number(e)),r=/^-?\d+(\.\d)?$/;if(!t){a.addIssue({code:M.z.ZodIssueCode.custom,message:"유효한 숫자여야 합니다."});return}if(0>parseFloat(e)){a.addIssue({code:M.z.ZodIssueCode.custom,message:"0 이상의 숫자만 입력 가능합니다."});return}if(/^-?\d+\.\d{2,}$/.test(e)){a.addIssue({code:M.z.ZodIssueCode.custom,message:"숫자는 소수점 한 자리까지만 입력 가능합니다."});return}if(/^[-+]?\d*(\.\d+)?([eE].+)?$/.test(e)&&!r.test(e)||!r.test(e)){a.addIssue({code:M.z.ZodIssueCode.custom,message:"유효한 숫자여야 합니다."});return}}).transform(e=>parseFloat(e)),U=M.z.object({date:M.z.string().min(1,"날짜를 입력해주세요."),counterparty:M.z.string().min(1,"업체를 입력해주세요."),amount:H,type:M.z.string()}),B=[{name:"type",label:"타입",type:"select",required:!0,options:[{label:"수금",value:"income"},{label:"지출",value:"expense"}]},{name:"date",label:"날짜",type:"date",required:!0},{name:"counterparty",label:"업체",type:"text",required:!0},{name:"amount",label:"금액",type:"text",required:!0,endAdornment:"백만원"}];function _({onClose:e,submitLabel:a="저장"}){let t=(0,s.Xr)(m),[n,l]=(0,i.useState)({}),[o]=(0,s.fp)(u),d=async a=>{try{await P({...a,companyId:o,amount:Number(a.amount)}),t(e=>e+1),l({}),e?.()}catch(e){e instanceof Error?l({accountNumber:e.message}):l({accountNumber:"오류가 발생했습니다."})}};return(0,r.jsx)(E.A,{fields:B,onSubmit:d,submitLabel:a,zodSchema:U,fieldErrors:n})}let F=M.z.object({companyBalance:D}),L=[{name:"companyBalance",label:"잔액",type:"text",required:!0,defaultValue:"0",endAdornment:"백만원"}];function T({onClose:e,submitLabel:a="설정"}){let t=(0,s.Xr)(m),[n,l]=(0,i.useState)({}),[o]=(0,s.fp)(u),[d]=(0,s.fp)(x),c=(0,s.Xr)(y),f=async a=>{try{await N(Number(a.companyBalance),o),c(Number(a.companyBalance)),t(e=>e+1),l({}),e?.()}catch(e){e instanceof Error?l({accountNumber:e.message}):l({accountNumber:"오류가 발생했습니다."})}};return(0,r.jsx)(E.A,{fields:L,onSubmit:f,submitLabel:a,zodSchema:F,fieldErrors:n,initialValues:{companyBalance:d.toString()}})}let $=(0,v.createServerReference)("6044a60bb253633318b81ddcf73aa28c0e2571fd55",v.callServer,void 0,v.findSourceMapURL,"updateCashflow"),X=M.z.object({date:M.z.string().min(1,"날짜를 입력해주세요."),counterparty:M.z.string().min(1,"업체를 입력해주세요."),amount:H,type:M.z.string()}),G=[{name:"type",label:"타입",type:"select",required:!0,options:[{label:"수금",value:"income"},{label:"지출",value:"expense"}]},{name:"date",label:"날짜",type:"date",required:!0},{name:"counterparty",label:"업체",type:"text",required:!0},{name:"amount",label:"금액",type:"text",required:!0,endAdornment:"백만원"}];function K({onClose:e,submitLabel:a="수정"}){let t=(0,s.Xr)(m),[n,l]=(0,i.useState)({}),[o]=(0,s.fp)(u),d=(0,s.md)(b),c=(0,s.md)(h),f=1===d.length?d[0]:1===c.length?c[0]:void 0,p=async a=>{if(!f){l({accountNumber:"수정할 내역이 선택되지 않았습니다."});return}try{await $({...a,amount:Number(a.amount),companyId:o},f.id),t(e=>e+1),l({}),e?.()}catch(e){e instanceof Error?l({accountNumber:e.message}):l({accountNumber:"오류가 발생했습니다."})}};return f?(0,r.jsx)(E.A,{fields:G,onSubmit:p,submitLabel:a,zodSchema:X,fieldErrors:n,initialValues:{type:f.type,date:f.date,counterparty:f.counterparty,amount:String(f.amount)}}):(0,r.jsx)("div",{children:"수정할 내역을 선택해주세요."})}function V({open:e,onClose:a}){return(0,r.jsxs)(z.A,{open:e,onClose:a,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(I.A,{children:"목록 추가"}),(0,r.jsx)(W.A,{children:(0,r.jsx)(_,{onClose:a})})]})}function Z({open:e,onClose:a}){let t=(0,s.md)(h),l=(0,s.md)(b),o=(0,s.Xr)(m);async function i(){await R(t.map(e=>e.id)),await R(l.map(e=>e.id)),o(e=>e+1),a()}return(0,r.jsxs)(z.A,{open:e,onClose:a,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(I.A,{children:"내역 삭제 확인"}),(0,r.jsx)(W.A,{sx:{py:3},children:"정말로 선택한 내역을 삭제하시겠습니까?"}),(0,r.jsxs)(q.A,{sx:{px:3,pb:2,pt:0,justifyContent:"flex-end"},children:[(0,r.jsx)(n.A,{variant:"outlined",color:"primary",onClick:a,children:"취소"}),(0,r.jsx)(n.A,{variant:"contained",color:"primary",onClick:i,children:"삭제"})]})]})}function O({open:e,onClose:a}){return(0,r.jsxs)(z.A,{open:e,onClose:a,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(I.A,{children:"잔액 설정"}),(0,r.jsx)(W.A,{children:(0,r.jsx)(T,{onClose:a})})]})}function Y({open:e,onClose:a}){return(0,r.jsxs)(z.A,{open:e,onClose:a,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsx)(I.A,{children:"내역 수정"}),(0,r.jsx)(W.A,{children:(0,r.jsx)(K,{onClose:a})})]})}var J=t(68792),Q=t(1816);function ee(){let[e,a]=(0,i.useState)(!1),[t,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),[f,x]=(0,i.useState)(!1),[y,w]=(0,s.fp)(p),[v,A]=(0,s.fp)(u),j=(0,s.md)(b),S=(0,s.md)(h),z=(0,s.Xr)(m),I=async()=>{let e=await k();w(e),A(""===v?e[0].id:v)},[W,q]=(0,s.fp)(g);async function E(){var e,a;await N((e=j.filter(e=>"balance-row"!==e.id),a=S,e.reduce((e,a)=>e+a.amount,0)-a.reduce((e,a)=>e+a.amount,0)+(y.find(e=>e.id===v)?.companyBalance??0)),v),await R(j.map(e=>e.id)),await R(S.map(e=>e.id)),z(e=>e+1),I()}return(0,r.jsxs)("div",{className:"w-full min-h-screen bg-gray-100",children:[(0,r.jsxs)("div",{className:"p-4 sm:p-8",children:[(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6",children:"수금 지출 관리"}),(0,r.jsxs)(l.A,{direction:"row",spacing:2,children:[(0,r.jsx)("div",{className:"flex flex-row justify-between items-end flex-shrink-0",style:{minHeight:24},children:(0,r.jsx)(J.A,{value:v,onChange:(e,a)=>A(a),scrollButtons:"auto",children:y.map(e=>(0,r.jsx)(Q.A,{label:e.name,value:e.id},e.id))})}),(0,r.jsxs)(l.A,{direction:"row",spacing:2,className:"w-full justify-end mb-4 sm:mb-6",children:[(0,r.jsx)(n.A,{variant:"contained",color:"primary",sx:{minWidth:120,minHeight:44,maxHeight:44,fontWeight:600,fontSize:16,lineHeight:1.5,py:0,backgroundColor:"#22C55E","&:hover":{backgroundColor:"#16A34A"},boxShadow:"none",alignSelf:"flex-end"},onClick:e=>{e.currentTarget.blur(),o(!0)},children:"잔액 설정"}),(0,r.jsx)(n.A,{variant:"contained",color:"primary",disabled:0===j.length&&0===S.length,sx:{minWidth:120,minHeight:44,maxHeight:44,fontWeight:600,fontSize:16,lineHeight:1.5,py:0,backgroundColor:"#22C55E","&:hover":{backgroundColor:"#16A34A"},boxShadow:"none",alignSelf:"flex-end"},onClick:e=>{e.currentTarget.blur(),c(!0)},children:"선택 목록 삭제"}),(0,r.jsx)(n.A,{variant:"contained",color:"primary",disabled:(1!==j.length||0!==S.length)&&(0!==j.length||1!==S.length),sx:{minWidth:120,minHeight:44,maxHeight:44,fontWeight:600,fontSize:16,lineHeight:1.5,py:0,backgroundColor:"#22C55E","&:hover":{backgroundColor:"#16A34A"},boxShadow:"none",alignSelf:"flex-end"},onClick:e=>{e.currentTarget.blur(),x(!0)},children:"선택 목록 수정"}),(0,r.jsx)(n.A,{variant:"contained",color:"primary",disabled:0===j.length&&0===S.length,sx:{minWidth:120,minHeight:44,maxHeight:44,fontWeight:600,fontSize:16,lineHeight:1.5,py:0,backgroundColor:"#22C55E","&:hover":{backgroundColor:"#16A34A"},boxShadow:"none",alignSelf:"flex-end"},onClick:e=>{e.currentTarget.blur(),E()},children:"선택 목록 반영"}),(0,r.jsx)(n.A,{className:"px-4 py-2 bg-primary-main text-white rounded-lg hover:bg-primary-dark transition-colors",variant:"contained",color:"primary",sx:{minWidth:120,minHeight:44,maxHeight:44,fontWeight:600,fontSize:16,lineHeight:1.5,py:0,backgroundColor:"#22C55E","&:hover":{backgroundColor:"#16A34A"},boxShadow:"none",alignSelf:"flex-end"},onClick:e=>{e.currentTarget.blur(),a(!0)},children:"목록 추가"}),(0,r.jsx)(n.A,{variant:"contained",color:"secondary",sx:{minWidth:120,minHeight:44,maxHeight:44,fontWeight:600,fontSize:16,lineHeight:1.5,py:0,backgroundColor:W?"#f3f4f6":"#64748b",color:W?"#374151":"#fff","&:hover":{backgroundColor:W?"#e5e7eb":"#475569"},boxShadow:"none",border:W?"1px solid #cbd5e1":"none",alignSelf:"flex-end"},onClick:e=>{e.currentTarget.blur(),q(e=>!e)},children:W?"편집 종료":"편집 모드"})]})]}),(0,r.jsx)(C,{})]}),(0,r.jsx)(V,{open:e,onClose:()=>a(!1)}),(0,r.jsx)(O,{open:t,onClose:()=>o(!1)}),(0,r.jsx)(Z,{open:d,onClose:()=>c(!1)}),(0,r.jsx)(Y,{open:f,onClose:()=>x(!1)})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66778:(e,a,t)=>{"use strict";var r=t(33333);a.A=void 0;var n=r(t(67329)),l=t(11432);a.A=(0,n.default)((0,l.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove")},71227:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>d});var r=t(65282),n=t(20277),l=t(47757),o=t.n(l),i=t(96002),s={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>i[e]);t.d(a,s);let d={children:["",{children:["cashflow",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,45786)),"/Users/kang-yean-woo/gompyo/src/app/cashflow/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,34421))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,98445)),"/Users/kang-yean-woo/gompyo/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,24327)),"/Users/kang-yean-woo/gompyo/src/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,68366,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,75895,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,34421))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/kang-yean-woo/gompyo/src/app/cashflow/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/cashflow/page",pathname:"/cashflow",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},77598:e=>{"use strict";e.exports=require("node:crypto")},79551:e=>{"use strict";e.exports=require("url")},87550:e=>{"use strict";e.exports=require("better-sqlite3")},92711:(e,a,t)=>{"use strict";var r=t(33333);a.A=void 0;var n=r(t(67329)),l=t(11432);a.A=(0,n.default)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},93598:(e,a,t)=>{Promise.resolve().then(t.bind(t,55983))}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[883,323,91,36,718,293,560,289,547,340],()=>t(71227));module.exports=r})();
